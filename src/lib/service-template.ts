import { ServiceTemplateData } from "@/components/ServiceTemplate";

export const defaultServiceTemplateData: ServiceTemplateData = {
  hero: {
    breadcrumbs: "Home > Services",
    title: "",
    description: "",
    primaryButtonText: "Let's discuss your needs",
    primaryButtonLink: "/contact",
    backgroundImage: "",
    backgroundVideo: "",
    backgroundOpacity: 0.3,
  },
  overview: {
    title: "Machine Learning & AI Development Services",
    paragraphs: [
      {
        text: "Softonoma, headquartered in Ho Chi Minh City, Vietnam, and with representative offices in Singapore and the United States, provides a broad range of qualified technical expertise in machine learning, deep learning, computer vision, classification tools, data analytics, natural language processing, and other areas.",
      },
      {
        text: "If you're looking for an AI development firm, we've got a team of data scientists, machine learning engineers, and software developers that are well versed in cutting-edge AI (Artificial Intelligence), ML (Machine Learning), and Big Data tool-sets to help you solve your business challenges.",
      },
    ],
    image: "",
    isActive: true,
  },
  stats: {
    items: [
      {
        icon: "ðŸ‘¥",
        value: "400+",
        label: "Software Developers",
      },
      {
        icon: "ðŸ“…",
        value: "13+",
        label: "Years in Business",
      },
      {
        icon: "âœ…",
        value: "800+",
        label: "Projects Successfully Delivered",
      },
      {
        icon: "â­",
        value: "4.8",
        label: "Star Rating on Clutch",
      },
    ],
    isActive: true,
  },
  subServices: {
    title: "Our AI Development Services",
    items: [
      {
        icon: "âš¡",
        title: "Machine Learning",
        description:
          "Use Machine Learning to build cognitive technology frameworks that will help you",
      },
      {
        icon: "ðŸ–¥ï¸",
        title: "Computer Vision",
        description:
          "With computer vision development services, we assist companies in improving the",
      },
      {
        icon: "ðŸ’¬",
        title: "Natural Language Processing (NLP)",
        description:
          "With our NLP software solutions, you may teach computers to grasp and interpret data",
      },
      {
        icon: "ðŸ“±",
        title: "Image Recognition",
        description:
          "With computer vision capabilities for picture recognition and object identification, custom",
      },
      {
        icon: "ðŸ¤–",
        title: "AI Assisted Chatbot Development",
        description:
          "Our AI chatbot creation services may help you improve your customer service by",
      },
      {
        icon: "ðŸ“Š",
        title: "AI and Business Intelligence",
        description:
          "Deep knowledge in the creation of Artificial Intelligence software employing advanced",
      },
    ],
    ctaButtonText: "Reach Out to Our Specialists",
    ctaButtonLink: "/contact",
    isActive: true,
  },
  whyChooseUs: {
    title: "Why Choose Softonoma?",
    subtitle:
      "Choose us for your AI development needs. Here's why we stand out.",
    items: [
      {
        text: "Pioneering AI Solutions",
      },
      {
        text: "Driving Innovation and Talent Development",
      },
      {
        text: "Global Expertise and ISO-Certified Excellence",
      },
    ],
    image: "",
    certifications: [],
    isActive: true,
  },
  technologies: {
    title: "Technologies & Tools",
    description: "Technologies we use to deliver results",
    items: [
      { name: "Technology 1", icon: "ðŸš€" },
      { name: "Technology 2", icon: "âš¡" },
    ],
    isActive: true,
  },
  process: {
    title: "Our Process",
    description: "How we deliver results",
    steps: [
      {
        number: "1",
        title: "Step 1",
        description: "Description of step 1",
      },
      {
        number: "2",
        title: "Step 2",
        description: "Description of step 2",
      },
      {
        number: "3",
        title: "Step 3",
        description: "Description of step 3",
      },
      {
        number: "4",
        title: "Step 4",
        description: "Description of step 4",
      },
    ],
    isActive: true,
  },
  portfolio: {
    title: "Our Portfolio",
    projects: [
      {
        title: "Project 1",
        description: "Description of project 1",
        category: "AI and ML",
        link: "#",
        technologies: ["React", "Node.js"],
      },
    ],
    isActive: true,
  },
  partners: {
    title: "Our Partners",
    description: "Trusted by leading companies worldwide",
    partners: [
      {
        name: "Partner 1",
        logo: "https://cloud.appwrite.io/v1/storage/buckets/694cc45b003184dc8584/files/6954ba5d003008864d7b/view?project=694cc43b00225b94d30d",
      },
      {
        name: "Partner 2",
        logo: "https://cloud.appwrite.io/v1/storage/buckets/694cc45b003184dc8584/files/6954ba62001457f024ef/view?project=694cc43b00225b94d30d",
      },
      {
        name: "Partner 3",
        logo: "https://cloud.appwrite.io/v1/storage/buckets/694cc45b003184dc8584/files/6954ba6700016cac0e12/view?project=694cc43b00225b94d30d",
      },
      {
        name: "Partner 4",
        logo: "https://cloud.appwrite.io/v1/storage/buckets/694cc45b003184dc8584/files/6954ba6b0032b310923f/view?project=694cc43b00225b94d30d",
      },
      {
        name: "Partner 5",
        logo: "https://cloud.appwrite.io/v1/storage/buckets/694cc45b003184dc8584/files/6954ba7100113ef921e4/view?project=694cc43b00225b94d30d",
      },
      {
        name: "Partner 6",
        logo: "https://cloud.appwrite.io/v1/storage/buckets/694cc45b003184dc8584/files/6954ba7c0012eee875af/view?project=694cc43b00225b94d30d",
      },
      {
        name: "Partner 7",
        logo: "https://cloud.appwrite.io/v1/storage/buckets/694cc45b003184dc8584/files/6954ba760029ccc019e4/view?project=694cc43b00225b94d30d",
      },
      {
        name: "Partner 8",
        logo: "https://cloud.appwrite.io/v1/storage/buckets/694cc45b003184dc8584/files/6954ba810038059a3274/view?project=694cc43b00225b94d30d",
      },
      {
        name: "Partner 9",
        logo: "https://cloud.appwrite.io/v1/storage/buckets/694cc45b003184dc8584/files/6954ba900020801ed88d/view?project=694cc43b00225b94d30d",
      },
      {
        name: "Partner 10",
        logo: "https://cloud.appwrite.io/v1/storage/buckets/694cc45b003184dc8584/files/6954ba94003bdd021354/view?project=694cc43b00225b94d30d",
      },
    ],
    isActive: true,
  },
  cards: {
    title: "What Our Clients Say",
    description: "Testimonials from satisfied customers",
    showStars: true,
    items: [
      {
        quote: "Great service and excellent results!",
        author: "John Doe",
        role: "CEO",
        company: "Company Inc.",
      },
    ],
    isActive: true,
  },
  faq: {
    title: "FAQs",
    items: [
      {
        question: "Question 1?",
        answer: "Answer to question 1",
      },
      {
        question: "Question 2?",
        answer: "Answer to question 2",
      },
    ],
    isActive: true,
  },
  cta: {
    title: "Ready to Get Started?",
    description: "Let's discuss how we can help your business grow.",
    buttonText: "Contact Us",
    buttonLink: "/contact",
    isActive: true,
  },
  sectionOrder: [
    "hero",
    "overview",
    "stats",
    "subServices",
    "whyChooseUs",
    "technologies",
    "process",
    "portfolio",
    "partners",
    "cards",
    "faq",
    "cta",
  ],
};

export function parseServiceTemplateData(
  content: string
): ServiceTemplateData | null {
  if (!content || content.trim() === "") return null;
  try {
    const parsed = JSON.parse(content);
    // Merge with defaults to ensure all fields exist
    const merged: ServiceTemplateData = {
      hero: {
        ...defaultServiceTemplateData.hero,
        ...(parsed.hero || {}),
      },
      overview: {
        ...defaultServiceTemplateData.overview,
        ...(parsed.overview || {}),
        paragraphs:
          parsed.overview?.paragraphs ||
          defaultServiceTemplateData.overview.paragraphs,
      },
      stats: parsed.stats
        ? {
            ...defaultServiceTemplateData.stats,
            ...parsed.stats,
            items:
              parsed.stats.items ||
              defaultServiceTemplateData.stats?.items ||
              [],
          }
        : defaultServiceTemplateData.stats,
      subServices: parsed.subServices
        ? {
            ...defaultServiceTemplateData.subServices,
            ...parsed.subServices,
            items:
              parsed.subServices.items ||
              defaultServiceTemplateData.subServices?.items ||
              [],
          }
        : defaultServiceTemplateData.subServices,
      whyChooseUs: parsed.whyChooseUs
        ? {
            ...defaultServiceTemplateData.whyChooseUs,
            ...parsed.whyChooseUs,
            items:
              parsed.whyChooseUs.items ||
              defaultServiceTemplateData.whyChooseUs?.items ||
              [],
            certifications:
              parsed.whyChooseUs.certifications ||
              defaultServiceTemplateData.whyChooseUs?.certifications ||
              [],
          }
        : defaultServiceTemplateData.whyChooseUs,
      technologies: parsed.technologies
        ? {
            ...defaultServiceTemplateData.technologies,
            ...parsed.technologies,
            items:
              parsed.technologies.items ||
              defaultServiceTemplateData.technologies?.items ||
              [],
          }
        : defaultServiceTemplateData.technologies,
      process: parsed.process
        ? {
            ...defaultServiceTemplateData.process,
            ...parsed.process,
            steps:
              parsed.process.steps ||
              defaultServiceTemplateData.process?.steps ||
              [],
          }
        : defaultServiceTemplateData.process,
      portfolio: parsed.portfolio
        ? {
            ...defaultServiceTemplateData.portfolio,
            ...parsed.portfolio,
            projects:
              parsed.portfolio.projects ||
              defaultServiceTemplateData.portfolio?.projects ||
              [],
          }
        : defaultServiceTemplateData.portfolio,
      partners: parsed.partners
        ? {
            ...defaultServiceTemplateData.partners,
            ...parsed.partners,
            partners:
              parsed.partners.partners ||
              defaultServiceTemplateData.partners?.partners ||
              [],
          }
        : defaultServiceTemplateData.partners,
      cards: parsed.cards
        ? {
            ...defaultServiceTemplateData.cards,
            ...parsed.cards,
            items:
              parsed.cards.items ||
              defaultServiceTemplateData.cards?.items ||
              [],
          }
        : defaultServiceTemplateData.cards,
      faq: parsed.faq
        ? {
            ...defaultServiceTemplateData.faq,
            ...parsed.faq,
            items:
              parsed.faq.items || defaultServiceTemplateData.faq?.items || [],
          }
        : defaultServiceTemplateData.faq,
      cta: parsed.cta
        ? { ...defaultServiceTemplateData.cta, ...parsed.cta }
        : defaultServiceTemplateData.cta,
      sectionOrder:
        parsed.sectionOrder && Array.isArray(parsed.sectionOrder)
          ? parsed.sectionOrder
          : defaultServiceTemplateData.sectionOrder || [
              "hero",
              "overview",
              "stats",
              "subServices",
              "whyChooseUs",
              "technologies",
              "process",
              "portfolio",
              "partners",
              "cards",
              "faq",
              "cta",
            ],
    };
    return merged;
  } catch (error) {
    console.error("Error parsing service template data:", error);
    console.error("Content that failed to parse:", content?.substring(0, 200));
    return null;
  }
}

// Service-specific content templates
import { ServiceContentTemplate } from "./service-templates/types";
import { getCustomSoftwareTemplate } from "./service-templates/custom-software";
import { getDevOpsTemplate } from "./service-templates/devops";
import { getFrontendTemplate } from "./service-templates/frontend";
import { getBackendTemplate } from "./service-templates/backend";
import { getMobileTemplate } from "./service-templates/mobile";
import { getUIUXTemplate } from "./service-templates/uiux";
import { getWebTemplate } from "./service-templates/web";
import { getSaaSTemplate } from "./service-templates/saas";
import { getGenericTemplate } from "./service-templates/generic";

function detectServiceType(title: string): string {
  const lowerTitle = title.toLowerCase();

  if (
    lowerTitle.includes("custom software") ||
    lowerTitle.includes("software development")
  ) {
    return "custom-software";
  }
  if (lowerTitle.includes("devops") || lowerTitle.includes("dev ops")) {
    return "devops";
  }
  if (
    lowerTitle.includes("front end") ||
    lowerTitle.includes("frontend") ||
    lowerTitle.includes("front-end")
  ) {
    return "frontend";
  }
  if (
    lowerTitle.includes("back end") ||
    lowerTitle.includes("backend") ||
    lowerTitle.includes("back-end")
  ) {
    return "backend";
  }
  if (
    lowerTitle.includes("mobile app") ||
    lowerTitle.includes("mobile application")
  ) {
    return "mobile";
  }
  if (
    lowerTitle.includes("web development") ||
    lowerTitle.includes("web app")
  ) {
    return "web";
  }
  if (
    lowerTitle.includes("ui/ux") ||
    lowerTitle.includes("ui ") ||
    lowerTitle.includes("ux ")
  ) {
    return "uiux";
  }
  if (
    lowerTitle.includes("saas") ||
    lowerTitle.includes("software as a service") ||
    lowerTitle.includes("software-as-a-service")
  ) {
    return "saas";
  }

  return "generic";
}

function getServiceContentTemplate(
  serviceType: string,
  title: string
): ServiceContentTemplate {
  switch (serviceType) {
    case "custom-software":
      return getCustomSoftwareTemplate(title);
    case "devops":
      return getDevOpsTemplate(title);
    case "frontend":
      return getFrontendTemplate(title);
    case "backend":
      return getBackendTemplate(title);
    case "mobile":
      return getMobileTemplate(title);
    case "uiux":
      return getUIUXTemplate(title);
    case "web":
      return getWebTemplate(title);
    case "saas":
      return getSaaSTemplate(title);
    default:
      return getGenericTemplate(title);
  }
}

// Legacy code removed - templates are now in separate files

export function getDefaultServiceTemplateForTitle(
  title: string
): ServiceTemplateData {
  const serviceType = detectServiceType(title);
  const template = getServiceContentTemplate(serviceType, title);

  return {
    hero: {
      breadcrumbs: `Home > Services > ${title}`,
      title: template.hero.title,
      description: template.hero.description,
      primaryButtonText: template.hero.primaryButtonText,
      primaryButtonLink: "/contact",
      backgroundImage: "",
      backgroundVideo: "",
      backgroundOpacity: 0.3,
    },
    overview: {
      title: template.overview.title,
      paragraphs: template.overview.paragraphs.map((text) => ({ text })),
      image: template.overview.image,
      isActive: true,
    },
    stats: {
      items: template.stats,
      isActive: true,
    },
    subServices: {
      title: `Our ${title} Services`,
      items: template.subServices,
      ctaButtonText: "Reach Out to Our Specialists",
      ctaButtonLink: "/contact",
      isActive: true,
    },
    whyChooseUs: {
      title: "Why Partner With Us?",
      subtitle: template.whyChooseUs.subtitle,
      items: template.whyChooseUs.items.map((text) => ({ text })),
      image: template.whyChooseUs.image,
      certifications: [],
      isActive: true,
    },
    technologies: {
      title: "Technologies & Tools",
      description: "Technologies we use to deliver results",
      items: template.technologies,
      isActive: true,
    },
    process: {
      title: "Our Development Process",
      description:
        "A structured approach to deliver reliable and impactful software.",
      steps: template.process,
      isActive: true,
    },
    portfolio: {
      title: "Our Portfolio",
      projects: [
        {
          title: "Client Success Story",
          description: `How we helped a client achieve their goals with ${title.toLowerCase()} services.`,
          category: "Success",
          link: "#",
          technologies: ["React", "Node.js"],
        },
      ],
      isActive: true,
    },
    partners: {
      title: "Our Partners",
      description: "Trusted by leading companies worldwide",
      partners: template.partners,
      isActive: true,
    },
    cards: {
      title: "What Our Clients Say",
      description: "Testimonials from satisfied customers",
      showStars: true,
      items: template.testimonials,
      isActive: true,
    },
    faq: {
      title: "FAQs",
      items: template.faq,
      isActive: true,
    },
    cta: {
      title: template.cta.title,
      description: template.cta.description,
      buttonText: template.cta.buttonText,
      buttonLink: "/contact",
      isActive: true,
    },
    sectionOrder: [
      "hero",
      "overview",
      "stats",
      "subServices",
      "whyChooseUs",
      "technologies",
      "process",
      "portfolio",
      "partners",
      "cards",
      "faq",
      "cta",
    ],
  };
}
